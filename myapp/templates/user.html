{% extends "layout.html" %}

{% block css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/user.css') }}">
{% endblock %}

{% block title %}个人中心{% endblock %}

{% block body %}
    <div class="banner logo-center yellowhalf"></div>
    <div class="content">
        <h2 class="ft-xl yellowBar page-title ">个人中心</h2>
        <div class="user-con">
            <div class="user-info">
                <div class="user-img">
                    <img src="{{ url_for('static', filename='image/user/default_user.png') }}">
                </div>
                <div class="text">
                    <div class="username">{{ current_user.username }}</div>
                    <div class="ft-grey">{{ time_now }}好(,,• ₃ •,,)～</div>
                </div>
                <div class="btn ft-l" id="mdfy">修改个人信息</div>
            </div>
        </div>
        <div class="user-con">
            <h3 class="title">收货地址管理</h3>
            <ul class="address-list noscroll">
                <li class="addnew pointer"></li>
            </ul>
        </div>
        <div class="user-con">
            <h3 class="title">所有订单<span>待支付</span><span>待收货</span><span>已关闭</span></h3>
            <div class="user-order topay">
                <div class="head">
                    <div class="ft-xl">等待支付</div>
                    <div>
                        <span class="time">2016-05-19</span>
                        <div class="sum">
                            订单金额：<span class="ft-xl">103.60</span>
                        </div>
                        <span class="number">订单号：1887263719799100</span>
                    </div>
                </div>
                <ul class="order-list ft-m">
                    <li class="gds-con">
                        <div class="image" style="background-image: url({{ url_for('static', filename='image/goods/m1.png') }})"></div>
                        <div class="name"><b class="ellipsis">无印良品风U型抱枕</b><span>深灰白</span></div>
                        <div class="sum"><span class="price">67.70</span>x1</div>
                    </li>
                    <li class="gds-con">
                        <div class="image" style="background-image: url({{ url_for('static', filename='image/goods/m2.png') }})"></div>
                        <div class="name"><b class="ellipsis">日式单耳陶瓷碗</b><span>乳白色</span></div>
                        <div class="sum"><span class="price">26.00</span>x1</div>
                    </li>
                    <li class="gds-con">
                        <div class="image" style="background-image: url({{ url_for('static', filename='image/goods/m3.png') }})"></div>
                        <div class="name"><b class="ellipsis">创意木质手工皂盒</b><span>本木色</span></div>
                        <div class="sum"><span class="price">9.90</span>x1</div>
                    </li>
                </ul>
                <div class="user-order-btns">
                    <div class="btn pay">立即支付</div>
                    <div class="cancel pointer">取消订单</div>
                </div>
            </div>
            <div class="user-order sended">
                <div class="head">
                    <p class="ft-xl">已发货</p>
                    <p>
                        <span class="time">2016-05-19</span>
                        <div class="sum">
                            订单金额：<span class="ft-xl">103.60</span>
                        </div>
                        <span class="number">订单号：1887263719799100</span>
                    </p>
                </div>
                <ul class="order-list ft-m">
                    <li class="gds-con">
                        <div class="image" style="background-image: url({{ url_for('static', filename='image/goods/m1.png') }})"></div>
                        <div class="name">无印良品风U型抱枕<span>深灰白</span></div>
                        <div class="sum"><span class="price">67.70</span>x1</div>
                    </li>
                    <li class="gds-con">
                        <div class="image" style="background-image: url({{ url_for('static', filename='image/goods/m2.png') }})"></div>
                        <div class="name">日式单耳陶瓷碗<span>乳白色</span></div>
                        <div class="sum"><span class="price">26.00</span>x1</div>
                    </li>
                    <li class="gds-con">
                        <div class="image" style="background-image: url({{ url_for('static', filename='image/goods/m3.png') }})"></div>
                        <div class="name">创意木质手工皂盒<span>本木色</span></div>
                        <div class="sum"><span class="price">9.90</span>x1</div>
                    </li>
                </ul>
                <div class="user-order-btns">
                    <div class="btn pay">确认收货</div>
                </div>
            </div>
            <div class="user-order closed">
                <div class="head">
                    <p class="ft-xl">已关闭</p>
                    <p>
                        <span class="time">2016-05-19</span>
                        <div class="sum">
                            订单金额：<span class="ft-xl">103.60</span>
                        </div>
                        <span class="number">订单号：1887263719799100</span>
                    </p>
                </div>
                <ul class="order-list ft-m">
                    <li class="gds-con">
                        <div class="image" style="background-image: url({{ url_for('static', filename='image/goods/m1.png') }})"></div>
                        <div class="name">无印良品风U型抱枕<span>深灰白</span></div>
                        <div class="sum"><span class="price">67.70</span>x1</div>
                    </li>
                    <li class="gds-con">
                        <div class="image" style="background-image: url({{ url_for('static', filename='image/goods/m2.png') }})"></div>
                        <div class="name">日式单耳陶瓷碗<span>乳白色</span></div>
                        <div class="sum"><span class="price">26.00</span>x1</div>
                    </li>
                    <li class="gds-con">
                        <div class="image" style="background-image: url({{ url_for('static', filename='image/goods/m3.png') }})"></div>
                        <div class="name">创意木质手工皂盒<span>本木色</span></div>
                        <div class="sum"><span class="price">9.90</span>x1</div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="usredt-con user-mdfy popup">
        <form method="post">
            <div class="usredt-input">
                {{ user_form.username(class="username norepeat", placeholder="用户名") }}
                {{ user_form.password(class="password norepeat", placeholder="密码") }}
                {{ user_form.password2(class="password norepeat", placeholder="请重新输入密码") }}
            </div>
            {{ user_form.submit(class="btn save") }}
            <input class="btn cancel" id="cancel" value="取消"></input>
            {{ user_form.csrf_token }}
        </form>
    </div>
    <div class="usredt-con ads-mdfy popup">
        <form>
            <div class="usredt-input">
                <input type="text" class="name" placeholder="姓名">
                <input type="text" class="number" placeholder="手机号">
                <input type="text" class="province" class="half" placeholder="省份/自治区">
                <input type="text" class="city" class="half" placeholder="城市/地区">
                <input type="text" class="area" placeholder="区/县">
                <input type="text" class="location" placeholder="详细地址">
                <input type="text" class="code" placeholder="邮政编码">
            </div>
            <div class="btn save">保存</div>
            <div class="btn cancel">取消</div>
        </form>
    </div>
{% endblock %}

{% block js %}
    <script src="{{ url_for('static', filename='js/addresslist.js') }}"></script>
    <script>
        var ue = $('.usredt-con');
        var usredt = addressEdit(ue,al);
        var al = addressList($(".address-list"), [], function() {
            var that = this;
            $(".ads-mdfy").addClass("show");
            usredt.setAddress(that.data);
            ue.find(".save").one("click", function() {
                that.modify(usredt.getAddress());
                $(".ads-mdfy").removeClass("show");
            });
        });
        $(".address-list .addnew").on("click",function(){
            $(".ads-mdfy").addClass("show");
            usredt.setAddress({});
            ue.find(".save").one("click",function(){
                al.add(usredt.getAddress());
                $(".ads-mdfy").removeClass("show");
            });
        });
        al.add({
            name:"童陈陈",
            number:"15757116455",
            province:"浙江省",
            city:"杭州市",
            area:"西湖区",
            location:"留和路288号浙江工业大学屏峰校区"
        });
        

        cmn.toggleStatus($(".cart-radio .radio"),{});

    </script>
    <script type="text/javascript">
        {% if get_flashed_messages() %}
            $(".user-mdfy").addClass("show");
            var alertBox = function(text){
                var ab = $('<div class="alert-box">'+text+'</div>');

                $(".popup").append(ab);
                return function(){
                    ab.show();
                    $(".popup").one("click",function(){
                        ab.hide();
                    });
                };
            };
            {% for message in get_flashed_messages() %}
                alertBox(String("{{ message }}"))();
            {% endfor %}
        {% endif %}
        $("#mdfy").on("click",function(){
            $(".user-mdfy").addClass("show");
        });
        $("#cancel").on("click",function(){
            $(".user-mdfy").removeClass("show");
        });
    </script>
{% endblock %}