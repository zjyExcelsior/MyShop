{% extends "layout.html" %}
{% block css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/cart.css') }}">
{% endblock %}
{% block title %}购物车{% endblock %}
{% block body %}
    <div class="banner logo-center yellowhalf"></div>
    <div class="content">
        <h2 class="ft-xl yellowBar page-title ">购物车</h2>
        <ul class="order-list ft-m cart-list hoverShadow">
            {% for product in products.values() %}
                <li class="gds-con">
                    <div class="cart-radio"><i class="radio"></i></div>
                    <div class="image" style="background-image: url({{ product.get('img_url') }})"></div>
                    <div class="right">
                        <div class="name"><b class="ellipsis">{{ product.get('name') }}</b><span>{{ product.get('color_name') }}</span></div>
                        <div class="number-pick ft-l"><i class="dec"></i><span class="amount">{{ product.get('amount') }}</span><i class="add"></i></div>
                        <div class="sum"><span class="price">{{ product.get('price') }}</span>x1</div>
                        <div class="remove hoverYellow">删除</div>
                    </div>
                </li>
            {% endfor %}
        </ul>
        <div class="cart-sum">
            <div class="selected">已选中 <span id="products_total">1</span> 件商品</div>
            <div class="btn"><a href="{{ url_for('main.orderconfirm') }}">结算</a></div>
            <div class="price" id="total_price">0</div>
        </div>
    </div>
{% endblock %}

{% block js %}
    <script src="{{ url_for('static', filename='js/numInput.js') }}"></script>
    <script>
        cmn.toggleStatus($(".cart-radio .radio"),{}, function(){
            var active_total = $(".active").length;
            $('#products_total').text(active_total);
            // var active_amounts = $('.active').parents('.gds-con').find('.amount');
            // var active_prices = $('.active').parents('.gds-con').find('.sum .price');
            // active_amounts.each(function(index, element){
                
            // });
        });
        $(".gds-con .remove").on("click",function () {
            $(this).parents(".gds-con").remove();
        });
    </script>
{% endblock %}